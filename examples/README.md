# –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –º–æ–¥—É–ª—è text_message_restrictions

–≠—Ç–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è —Å–æ–¥–µ—Ä–∂–∏—Ç –ø—Ä–∏–º–µ—Ä—ã –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –º–æ–¥—É–ª—è `text_message_restrictions` —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞–º–∏ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —á–∞—Ç-–±–æ—Ç–æ–≤.

## üìÅ –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

### [`aiogram3_text_restriction_example.py`](./aiogram3_text_restriction_example.py)

–ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä –±–æ—Ç–∞ –Ω–∞ **aiogram 3.x** —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π.

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- ‚úÖ –ü–µ—Ä–µ—Ö–≤–∞—Ç –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
- ‚úÖ –û—Ç–ø—Ä–∞–≤–∫–∞ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º–æ–≥–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
- ‚úÖ –ö–Ω–æ–ø–æ—á–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
- ‚úÖ –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º
- ‚úÖ –ü—Ä–∏–º–µ—Ä—ã callback-–æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

**–£—Å—Ç–∞–Ω–æ–≤–∫–∞:**
```bash
pip install aiogram==3.4.1
```

**–ó–∞–ø—É—Å–∫:**
```bash
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ BOT_TOKEN –≤ —Ñ–∞–π–ª–µ
python examples/aiogram3_text_restriction_example.py
```

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```bash
pip install -r requirements.txt
```

### 2. –ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞

1. –ù–∞–ø–∏—à–∏—Ç–µ [@BotFather](https://t.me/BotFather) –≤ Telegram
2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤–æ–≥–æ –±–æ—Ç–∞ –∫–æ–º–∞–Ω–¥–æ–π `/newbot`
3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–π —Ç–æ–∫–µ–Ω

### 3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –±–æ—Ç–∞

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª –ø—Ä–∏–º–µ—Ä–∞ –∏ –∑–∞–º–µ–Ω–∏—Ç–µ `YOUR_BOT_TOKEN_HERE` –Ω–∞ –≤–∞—à —Ç–æ–∫–µ–Ω:

```python
BOT_TOKEN = "123456789:ABCdefGHIjklMNOpqrsTUVwxyz"
```

### 4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞

```bash
python examples/aiogram3_text_restriction_example.py
```

## üìù –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–Ω—Ü–µ–ø—Ç—ã

### –°–æ–∑–¥–∞–Ω–∏–µ –æ–≥—Ä–∞–Ω–∏—á–∏—Ç–µ–ª—è

```python
from text_message_restrictions import TextMessageRestriction

restriction = TextMessageRestriction(
    warning_message="–î–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–æ—Ç–æ–º –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫–∏! ‚¨áÔ∏è",
    allowed_commands=['/start', '/help'],
    enabled=True
)
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π

```python
@dp.message()
async def handle_message(message: types.Message):
    if restriction.should_restrict(message.text):
        await message.answer(restriction.warning_message)
        return
    # –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è...
```

### –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

```python
# –í–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å
restriction.enable()
restriction.disable()

# –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ
restriction.update_warning_message("–ù–æ–≤—ã–π —Ç–µ–∫—Å—Ç!")

# –î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–∞–Ω–¥—É
restriction.add_allowed_command('/settings')
```

## üéØ –°—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –°—Ç—Ä–æ–≥–æ–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ

```python
restriction = TextMessageRestriction(
    warning_message="‚ö†Ô∏è –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ–ª—å–∫–æ –∫–Ω–æ–ø–∫–∏!",
    allowed_commands=['/start'],
    enabled=True
)
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ú—è–≥–∫–æ–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ

```python
restriction = TextMessageRestriction(
    warning_message="üí° –î–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫–∏ –º–µ–Ω—é",
    allowed_commands=['/start', '/help', '/settings', '/admin'],
    enabled=True
)
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –ö–∞—Å—Ç–æ–º–Ω–∞—è –ª–æ–≥–∏–∫–∞

```python
def custom_validator(text: str) -> bool:
    """–†–∞–∑—Ä–µ—à–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç VIP-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π"""
    return is_vip_user(text)  # –í–∞—à–∞ —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏

restriction = TextMessageRestriction(
    custom_validator=custom_validator
)
```

## üîß –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –¥—Ä—É–≥–∏–º–∏ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞–º–∏

### Telebot

```python
import telebot
from text_message_restrictions import TextMessageRestriction

bot = telebot.TeleBot("TOKEN")
restriction = TextMessageRestriction()

@bot.message_handler(content_types=['text'])
def handle_text(message):
    if restriction.should_restrict(message.text):
        bot.send_message(
            message.chat.id,
            restriction.warning_message,
            parse_mode="HTML"
        )
        return
    # –û–±—Ä–∞–±–æ—Ç–∫–∞...

bot.polling()
```

### PyTelegramBotAPI

```python
from pyTelegramBotAPI import telebot
from text_message_restrictions import TextMessageRestriction

bot = telebot.TeleBot("TOKEN")
restriction = TextMessageRestriction()

@bot.message_handler(func=lambda m: True)
def handle_all_messages(message):
    if restriction.should_restrict(message.text):
        bot.reply_to(message, restriction.warning_message)
        return
    # –û–±—Ä–∞–±–æ—Ç–∫–∞...

bot.infinity_polling()
```

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [–ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](../docs/TEXT_RESTRICTION_GUIDE.md)
- [–ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ –º–æ–¥—É–ª—è](../src/text_message_restrictions.py)
- [–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å BotInstance](../src/bot_manager.py)

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ –±–µ–∑ —Å–æ–∑–¥–∞–Ω–∏—è –±–æ—Ç–∞:

```python
from text_message_restrictions import TextMessageRestriction

restriction = TextMessageRestriction()

test_cases = [
    ("/start", False),
    ("–ü—Ä–∏–≤–µ—Ç", True),
    ("/help", False),
    ("–ö–∞–∫ –¥–µ–ª–∞?", True)
]

for text, expected in test_cases:
    result = restriction.should_restrict(text)
    assert result == expected, f"–û—à–∏–±–∫–∞ –¥–ª—è '{text}'"
    print(f"‚úÖ '{text}' -> {'–û–≥—Ä–∞–Ω–∏—á–µ–Ω–æ' if result else '–†–∞–∑—Ä–µ—à–µ–Ω–æ'}")
```

## ‚ùì –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### –ü—Ä–æ–±–ª–µ–º–∞: –ë–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç

**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Ç–æ–∫–µ–Ω —É–∫–∞–∑–∞–Ω –≤–µ—Ä–Ω–æ –∏ –±–æ—Ç –∑–∞–ø—É—â–µ–Ω:

```python
# –î–æ–±–∞–≤—å—Ç–µ –æ—Ç–ª–∞–¥–∫—É
import logging
logging.basicConfig(level=logging.DEBUG)
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ:** –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –≤–∫–ª—é—á–µ–Ω–æ:

```python
print(f"–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –≤–∫–ª—é—á–µ–Ω–æ: {restriction.is_enabled()}")
restriction.enable()
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ö–æ–º–∞–Ω–¥—ã –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—ã –≤ —Å–ø–∏—Å–æ–∫ —Ä–∞–∑—Ä–µ—à—ë–Ω–Ω—ã—Ö:

```python
restriction.add_allowed_command('/mycommand')
```

## ü§ù –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ [–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é](../docs/TEXT_RESTRICTION_GUIDE.md)
2. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ [–ø—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞](../src/text_message_restrictions.py)
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –±–æ—Ç–∞

---

**–í–µ—Ä—Å–∏—è**: 1.0.0  
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: 2026-02-05
