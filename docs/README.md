# Max Bot - Информационный помощник для участников СВО

## Описание проекта

Max Bot - это виртуальный консультант Николай, предназначенный для информационной поддержки участников СВО и членов их семей. Бот предоставляет консультации по мерам социальной поддержки, льготам, выплатам и помогает в оформлении документов.

## Функциональность

- **Консультации по социальной поддержке**: информация о всех доступных мерах поддержки
- **Льготы и выплаты**: подробности о льготах и выплатах для участников СВО и ветеранов
- **Медицинская помощь**: информация о медицинской, юридической и психологической помощи
- **Оформление документов**: помощь в порядке оформления документов для получения мер поддержки
- **Подача заявок**: возможность подать заявки на реабилитационный сертификат и социальное такси

## Структура проекта

```
new_max_bot/
├── bot.py                  # Основной файл бота с логикой обработки сообщений
├── config.py               # Конфигурационный файл с токеном и настройками API
├── test_bot.py             # Тестовый скрипт для проверки работоспособности бота
├── check_config.py         # Скрипт для проверки конфигурации перед запуском
├── TOKEN_SETUP_INSTRUCTIONS.md  # Инструкция по настройке токена
├── bot.log                 # Файл логов работы бота
└── README.md               # Документация проекта
```

## Установка и запуск

### Требования

- Python 3.7+
- Библиотека requests

### Установка зависимостей

```bash
pip install requests
```

### Настройка

1. Склонируйте репозиторий
2. Получите токен API у разработчиков Max
3. Обновите файл `config.py` с правильными значениями:
   ```python
   TOKEN = "ваш_токен_здесь"
   BASE_URL = "https://platform-api.max.ru"
   APP_PAYLOAD = "ваш_app_payload_здесь"
   ```
4. Проверьте конфигурацию:
   ```bash
   python check_config.py
   ```
5. Запустите тестовый скрипт для проверки подключения:
   ```bash
   python test_bot.py
   ```
6. Запустите бота:
   ```bash
   python bot.py
   ```

## Диагностика и устранение неполадок

### Проверка конфигурации
Используйте скрипт `check_config.py` для проверки правильности настроек перед запуском бота.

### Тестирование подключения
Используйте скрипт `test_bot.py` для проверки подключения к API и валидности токена.

### Логирование
Все события, ошибки и успешные операции записываются в файл `bot.log`. Проверяйте этот файл при возникновении проблем.

### Настройка токена
Если бот не отвечает, скорее всего проблема в неправильном токене. См. файл `TOKEN_SETUP_INSTRUCTIONS.md` для получения инструкций по получению правильного токена.

## API интеграция

Бот использует Max Platform API для взаимодействия с платформой MAX. Документация API доступна по адресу: https://dev.max.ru/docs-api

### Используемые методы API:

- **Получение обновлений** (`GET /updates`) - Long polling для получения сообщений и колбэков
- **Отправка сообщений** (`POST /messages`) - Отправка текстовых сообщений и inline-клавиатур
- **Ответ на колбэки** (`POST /answers`) - Обработка нажатий на кнопки

### Аутентификация

Используется заголовок `Authorization: <token>` для аутентификации запросов к API.

### Ограничения

- Максимальное количество запросов: 30 rps на platform-api.max.ru
- Поддерживается только протокол HTTPS для вебхуков

### Inline-клавиатура

Бот использует inline-клавиатуры с кнопками типов:
- `callback` - для обработки нажатий на сервере
- `open_app` - для открытия мини-приложений (подача заявок)

## Основные команды

- `/start` - Запуск бота и отображение главного меню

## Категории поддержки

### Ветераны боевых действий
- Выплаты и льготы
- Транспортные льготы
- Имущественная поддержка
- Льготное питание
- Медицинская помощь и надомный уход
- Обеспечение лекарствами
- Отдых и оздоровление
- Психологическая помощь
- Социальная адаптация и трудоустройство
- Технические средства реабилитации
- Юридическая помощь
- Льготное посещение спортивных объектов

### Участники СВО
- Выплаты и льготы
- Имущественная поддержка
- Медицинская помощь и надомный уход
- Отдых и оздоровление
- Психологическая помощь
- Социальная адаптация и трудоустройство
- Юридическая помощь
- Льготное питание

## Разработка

### Архитектура

- `bot.py` - содержит основные функции для работы с API и обработки сообщений
- `config.py` - хранит конфигурационные данные (токен, URL API)
- `test_bot.py` - тестовый скрипт для проверки работоспособности
- `check_config.py` - скрипт проверки конфигурации

### Основные функции

- `get_updates()` - получение обновлений от API
- `send_message()` - отправка сообщений пользователям
- `answer_callback()` - обработка нажатий на кнопки
- `handle_message()` - обработка входящих сообщений
- `handle_callback()` - обработка колбэков от кнопок
- `get_bot_info()` - получение информации о текущем боте
- `validate_token()` - проверка валидности токена при запуске
- `logging` - система логирования для диагностики проблем

## Безопасность

- Токен API хранится в отдельном конфигурационном файле
- Рекомендуется добавить `config.py` в `.gitignore` при работе с репозиторием
- Для production сред рекомендуется использовать переменные окружения для хранения токена

## Поддержка

Для вопросов и предложений по улучшению бота, пожалуйста, обращайтесь к команде разработки.